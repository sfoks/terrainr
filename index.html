<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Retrieve Data from the USGS National Map and Transform it for 3D Landscape Visualizations â€¢ terrainr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Retrieve Data from the USGS National Map and Transform it for 3D Landscape Visualizations">
<meta property="og:description" content="Functions for the retrieval and manipulation of USGS National Map 
    data (&lt;https://viewer.nationalmap.gov/services/&gt;), enabling users to 
    download elevation and image data for areas of interest. Functions are also 
    provided to transform these data sources into formats that can be used to 
    create 3D elevation models in the Unity rendering engine.">
<meta property="og:image" content="https://mikemahoney218.github.io/terrainr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">terrainr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/overview.html">A Gentle Introduction to terrainr</a>
    </li>
    <li>
      <a href="articles/unity_instructions.html">Importing terrainr tiles into Unity</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/mikemahoney218/terrainr">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="terrainr-retrieve-data-from-the-usgs-national-map-and-transform-it-for-3d-landscape-visualizations-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#terrainr-retrieve-data-from-the-usgs-national-map-and-transform-it-for-3d-landscape-visualizations-" class="anchor"></a>terrainr: Retrieve Data from the USGS National Map and Transform it for 3D Landscape Visualizations <a href="https://mikemahoney218.github.io/terrainr/"><img src="reference/figures/logo.png" align="right" height="138.5"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>terrainr makes it easy to identify your area of interest from point data, retrieve geospatial data (including orthoimagery and DEMs) for areas of interest within the United States from the <a href="https://viewer.nationalmap.gov/services/">National Map family of APIs</a>, and then process that data into larger, joined images or crop it into tiles that can be imported into the Unity rendering engine.</p>
<p>At the absolute simplest level, terrainr provides a convenient and consistent API to downloading data from the National Map.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mikemahoney218.github.io/terrainr/">terrainr</a></span><span class="op">)</span>
<span class="va">simulated_data</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
                              lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">44.04905</span>, <span class="fl">44.17609</span><span class="op">)</span>, 
                              lng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">74.01188</span>, <span class="op">-</span><span class="fl">73.83493</span><span class="op">)</span><span class="op">)</span>

<span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_bbox.html">get_coord_bbox</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="va">simulated_data</span><span class="op">$</span><span class="va">lat</span>, lng <span class="op">=</span> <span class="va">simulated_data</span><span class="op">$</span><span class="va">lng</span><span class="op">)</span> 
<span class="va">output_tiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_tiles.html">get_tiles</a></span><span class="op">(</span>bbox <span class="op">=</span> <span class="va">bbox</span>,
                          services <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"elevation"</span>, <span class="st">"ortho"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># output_tiles is now a list of two vectors pointing to the elevation and </span>
<span class="co"># orthoimagery tiles we just downloaded -- here we're displaying the first</span>
<span class="co"># of the ortho tiles</span>
<span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="va">output_tiles</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/naip.png" width="100%"></p>
<p>Once downloaded, these images are in standard GeoTIFF or PNG formats and can be used as expected with other utilities:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>raster<span class="op">::</span><span class="kw">plot</span>(raster<span class="op">::</span><span class="kw">raster</span>(output_tiles[[<span class="dv">1</span>]][[<span class="dv">1</span>]]))elev</span></code></pre></div>
<p><img src="reference/figures/elevation.png" width="100%"></p>
<p>Additionally, terrainr provides functions to transform these tiles into RAW images ready to be imported into the Unity rendering engine, allowing you to fly or walk through your downloaded data sets in 3D or VR:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">merged_dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span>
<span class="va">merged_ortho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span>
<span class="co"># we can call these vectors by name instead of position, too</span>
<span class="fu"><a href="reference/merge_rasters.html">merge_rasters</a></span><span class="op">(</span><span class="va">output_tiles</span><span class="op">$</span><span class="va">`3DEPElevation`</span>, 
              <span class="va">merged_dem</span>, 
              <span class="va">output_tiles</span><span class="op">$</span><span class="va">USGSNAIPPlus</span>, 
              <span class="va">merged_ortho</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="reference/raster_to_raw_tiles.html">raster_to_raw_tiles</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="va">x</span>, 
                                          output_prefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span>, 
                                          side_length <span class="op">=</span> <span class="fl">4097</span>, 
                                          raw <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,
       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">merged_dem</span>, <span class="va">merged_ortho</span><span class="op">)</span>,
       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

<span class="co"># With about ten minutes of movie magic (loading the files into Unity), </span>
<span class="co"># we can turn that into:</span></code></pre></div>
<p><img src="reference/figures/unity-lakeside.jpg" width="100%"></p>
<p>terrainr also includes functionality to merge and crop the files youâ€™ve downloaded, and to resize your area of interest so youâ€™re sure to download exactly the area you want. Additionally, the more time intensive processing steps can all be monitored via the <a href="https://github.com/HenrikBengtsson/progressr">progressr</a> package, so youâ€™ll be more confident that your computer is still churning along and not just hung. For more information, check out <a href="https://mikemahoney218.github.io/terrainr/articles/overview.html">the introductory vignette</a> and <a href="https://mikemahoney218.github.io/terrainr/articles/unity_instructions.html">the guide to importing your data into Unity.</a></p>
</div>
<div id="available-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#available-datasets" class="anchor"></a>Available Datasets</h2>
<p>The following datasets can currently be downloaded using <code>get_tiles</code> or <code>hit_national_map_api</code>:</p>
<ul>
<li>
<a href="https://elevation.nationalmap.gov/arcgis/rest/services/3DEPElevation/ImageServer">3DEPElevation</a>: The USGS 3D Elevation Program (3DEP) Bare Earth DEM.</li>
<li>
<a href="https://services.nationalmap.gov/arcgis/rest/services/USGSNAIPPlus/MapServer">USGSNAIPPlus</a>: National Agriculture Imagery Program (NAIP) and high resolution orthoimagery (HRO).</li>
<li>
<a href="https://hydro.nationalmap.gov/arcgis/rest/services/nhd/MapServer">nhd</a>: A comprehensive set of digital spatial data that encodes information about naturally occurring and constructed bodies of surface water (lakes, ponds, and reservoirs), paths through which water flows (canals, ditches, streams, and rivers), and related entities such as point features (springs, wells, stream gauges, and dams).</li>
<li>
<a href="https://carto.nationalmap.gov/arcgis/rest/services/govunits/MapServer">govunits</a>: Major civil areas for the Nation, including States or Territories, counties (or equivalents), Federal and Native American areas, congressional districts, minor civil divisions, incorporated places (such as cities and towns), and unincorporated places.</li>
<li>
<a href="https://carto.nationalmap.gov/arcgis/rest/services/contours/MapServer">contours</a>: The USGS Elevation Contours service.</li>
<li>
<a href="https://carto.nationalmap.gov/arcgis/rest/services/geonames/MapServer">geonames</a>: Information about physical and cultural geographic features, geographic areas, and locational entities that are generally recognizable and locatable by name.</li>
<li>
<a href="https://hydro.nationalmap.gov/arcgis/rest/services/NHDPlus_HR/MapServer">NHDPlus_HR</a>: A comprehensive set of digital spatial data comprising a nationally seamless network of stream reaches, elevation-based catchment areas, flow surfaces, and value-added attributes.</li>
<li>
<a href="https://carto.nationalmap.gov/arcgis/rest/services/structures/MapServer">structures</a>: The name, function, location, and other core information and characteristics of selected manmade facilities.</li>
<li>
<a href="https://carto.nationalmap.gov/arcgis/rest/services/transportation/MapServer">transportation</a>: Roads, railroads, trails, airports, and other features associated with the transport of people or commerce.</li>
<li>
<a href="https://hydro.nationalmap.gov/arcgis/rest/services/wbd/MapServer">wbd</a>: Hydrologic Unit (HU) polygon boundaries for the United States, Puerto Rico, and the U.S. Virgin Islands.</li>
</ul>
<p>(All descriptions above taken from the <a href="https://viewer.nationalmap.gov/services/">National Map API descriptions</a>.)</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of terrainr from <a href="https://github.com/mikemahoney218/terrainr">GitHub</a> with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mikemahoney218/terrainr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that this package is released with a <a href="https://ropensci.org/code-of-conduct/">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mikemahoney218/terrainr/">https://â€‹github.com/â€‹mikemahoney218/â€‹terrainr/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mikemahoney218/terrainr/issues">https://â€‹github.com/â€‹mikemahoney218/â€‹terrainr/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michael Mahoney <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2402-304X" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://choosealicense.com/licenses/mit/"><img src="https://img.shields.io/badge/license-MIT-green" alt="License: MIT"></a></li>
<li><a href="https://CRAN.R-project.org/package=terrainr"><img src="https://www.r-pkg.org/badges/version/terrainr" alt="CRAN status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://codecov.io/gh/mikemahoney218/terrainr"><img src="https://codecov.io/gh/mikemahoney218/terrainr/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/mikemahoney218/terrainr/actions"><img src="https://github.com/mikemahoney218/terrainr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Michael Mahoney.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
